"use strict";(self.webpackChunkmechsix_github_io_source=self.webpackChunkmechsix_github_io_source||[]).push([[2050],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return k}});var l=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,l,r=function(e,t){if(null==e)return{};var n,l,r={},a=Object.keys(e);for(l=0;l<a.length;l++)n=a[l],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(l=0;l<a.length;l++)n=a[l],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=l.createContext({}),u=function(e){var t=l.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=u(e.components);return l.createElement(p.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return l.createElement(l.Fragment,{},t)}},m=l.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,p=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=u(n),k=r,d=m["".concat(p,".").concat(k)]||m[k]||s[k]||a;return n?l.createElement(d,o(o({ref:t},c),{},{components:n})):l.createElement(d,o({ref:t},c))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,o=new Array(a);o[0]=m;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:r,o[1]=i;for(var u=2;u<a;u++)o[u]=n[u];return l.createElement.apply(null,o)}return l.createElement.apply(null,n)}m.displayName="MDXCreateElement"},97453:function(e,t,n){n.r(t),n.d(t,{contentTitle:function(){return p},default:function(){return m},frontMatter:function(){return i},metadata:function(){return u},toc:function(){return c}});var l=n(87462),r=n(63366),a=(n(67294),n(3905)),o=["components"],i={title:"K8S 101",sidebar_label:"K8S 101"},p=void 0,u={unversionedId:"k8s/intro",id:"k8s/intro",title:"K8S 101",description:"Kubectl",source:"@site/docs/k8s/intro.md",sourceDirName:"k8s",slug:"/k8s/intro",permalink:"/docs/k8s/intro",editUrl:"https://github.dev/mechsix/mechsix.github.io.source/tree/master/docs/k8s/intro.md",tags:[],version:"current",frontMatter:{title:"K8S 101",sidebar_label:"K8S 101"},sidebar:"docSidebar",previous:{title:"STS",permalink:"/docs/aws/sts"},next:{title:"JS Data Operations",permalink:"/docs/cheatsheet/js-operation"}},c=[{value:"Kubectl",id:"kubectl",children:[],level:2},{value:"Master Node &amp; Worker Node",id:"master-node--worker-node",children:[],level:2},{value:"Namespace",id:"namespace",children:[],level:2},{value:"Pod / Deployment / ReplicaSet / DaemonSet / Job",id:"pod--deployment--replicaset--daemonset--job",children:[],level:2},{value:"Selector &amp; Label",id:"selector--label",children:[],level:2},{value:"Service / Ingress",id:"service--ingress",children:[],level:2},{value:"Configmap / Secret",id:"configmap--secret",children:[],level:2},{value:"ServiceAccount",id:"serviceaccount",children:[],level:2},{value:"Helm Chart",id:"helm-chart",children:[],level:2},{value:"Tools",id:"tools",children:[],level:2}],s={toc:c};function m(e){var t=e.components,n=(0,r.Z)(e,o);return(0,a.kt)("wrapper",(0,l.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"kubectl"},"Kubectl"),(0,a.kt)("p",null,"\u547d\u4ee4\u57fa\u672c\u683c\u5f0f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kubectl <action> <resource>\n# Action, Resource\u90fd\u4e0d\u5206\u5927\u5c0f\u5beb\n")),(0,a.kt)("p",null,"\u5217\u51fa\u6240\u6709pod"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kubectl get pods\n")),(0,a.kt)("p",null,"\u6aa2\u8996name\u662fapp-7yh8\u7684pod\u7684\u72c0\u614b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kubectl describe pods app-7yh8\n")),(0,a.kt)("p",null,"\u5217\u51fa\u6574\u5ea7cluster\u7684\u6240\u6709pod"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kubectl get pods --all-namespaces\n")),(0,a.kt)("p",null,"\u8981\u5c0f\u5fc3\u7684\u662f\uff0cedit, delete\u9019\u4e9baction\uff0c\u57f7\u884c\u4e0b\u53bb\u5c31\u6703\u5c0dcluster\u76ee\u524d\u7684\u8cc7\u6e90\u7522\u751f\u4fee\u6539"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kubectl edit pod app-7yh8\n")),(0,a.kt)("p",null,"\u525b\u958b\u59cb\u9032\u6709\u8dd1\u670d\u52d9\u7684K8S Cluster\uff0cdescribe, get\u9019\u4e9b\u4e0d\u6703\u6709side-effect\u7684\u547d\u4ee4\u53ef\u4ee5\u5148\u8a66\u8a66"),(0,a.kt)("h2",{id:"master-node--worker-node"},"Master Node & Worker Node"),(0,a.kt)("p",null,"Node\u662f\u6307\u52a0\u5165Cluster\u7684\u6a5f\u5668\u672c\u8eab\n\u4e00\u822c\u4f86\u8aaa\u5c31\u662f\u6307\u5be6\u9ad4\u6a5f\u5668\u6216VM"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Master Node",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u4e0d\u80fd\u8dd1Pod"),(0,a.kt)("li",{parentName:"ul"},"\u6700\u5c0f3\u500b\uff0c\u5fc5\u9808\u662f\u5947\u6578\u500b\uff0c\u5f7c\u6b64\u5728\u8cc7\u6599\u4e0d\u4e00\u81f4\u6642\u6703\u900f\u904e\u9078\u8209\u53d6\u5f97\u5171\u8b58"))),(0,a.kt)("li",{parentName:"ul"},"Worker Node",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u8dd1Pod\u7684\u5730\u65b9")))),(0,a.kt)("p",null,"\u770b\u76ee\u524dCluster\u7684Node\u6e05\u55ae"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kubectl get node\n")),(0,a.kt)("p",null,"\u52a0\u4e0a",(0,a.kt)("inlineCode",{parentName:"p"},"-o wide"),"\uff0c\u53ef\u4ee5\u5728\u6e05\u55ae\u4e2d\u770b\u5230\u66f4\u7d30\u7684\u8cc7\u8a0a\uff0c\u4f8b\u5982\u5404Node\u7684IP Address"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kubectl get node -o wide\n")),(0,a.kt)("h2",{id:"namespace"},"Namespace"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u62bd\u8c61\u7684\u670d\u52d9\u7a7a\u9593\uff0c\u5728\u540c\u4e00\u500bnamespace\u4e0b\u7684\u8cc7\u6e90\uff0c\u5f7c\u6b64\u6e9d\u901a\u6703\u6bd4\u8f03\u65b9\u4fbf",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u6709\u4e9b\u8cc7\u6e90\u7121\u6cd5\u8de8Namespace\u88ab\u5b58\u53d6\uff0c\u4f8b\u5982Secrets, Configmap"))),(0,a.kt)("li",{parentName:"ul"},"\u6709\u5e7e\u500b\u4fdd\u7559\u7684namespace",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"default",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u6c92\u6709\u6307\u5b9anamespace\u7684\u8cc7\u6e90\u6703\u8d77\u5230default \u9019\u500bnamespace\u4e0b"))),(0,a.kt)("li",{parentName:"ul"},"kube-system",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u4fdd\u7559\u7d66Cluster\u672c\u8eab\u4f7f\u7528\uff0c\u8dd1\u5728\u9019\u500bnamespace\u7684\u8cc7\u6e90\u90fd\u5c6c\u65bcCluster\u7684\u57fa\u790e\u670d\u52d9\u7684\u4e00\u90e8\u4efd")))))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kubectl get namespaces\n\n# \u53ef\u4ee5\u7c21\u5beb\nkubectl get ns\n")),(0,a.kt)("h2",{id:"pod--deployment--replicaset--daemonset--job"},"Pod / Deployment / ReplicaSet / DaemonSet / Job"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Pod: \u6700\u5c0f\u88ab\u8abf\u5ea6\u7684\u55ae\u4f4d"),(0,a.kt)("li",{parentName:"ul"},"Deployment: Declaration\uff0c\u4e00\u822c\u4f86\u8aaa\u5de5\u7a0b\u5e2b\u64cd\u4f5c\u5230\u9019\u500b\u5c64\u7d1a",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"ReplicaSet"),(0,a.kt)("li",{parentName:"ul"},"DaemonSet"))),(0,a.kt)("li",{parentName:"ul"},"Job")),(0,a.kt)("h2",{id:"selector--label"},"Selector & Label"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Metadata.labels"),(0,a.kt)("li",{parentName:"ul"},"\u6709\u4fdd\u7559\u5b57\uff0c\u6709\u4e9b\u540d\u5b57\u4e0d\u80fd\u7528: ",(0,a.kt)("a",{parentName:"li",href:"https://kubernetes.io/docs/reference/labels-annotations-taints/"},"https://kubernetes.io/docs/reference/labels-annotations-taints/"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# \u9078\u64c7\u6240\u6709key=value\u7684pod\nkubectl get pods -l key=value\n")),(0,a.kt)("h2",{id:"service--ingress"},"Service / Ingress"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Service: \u63d0\u4f9b\u670d\u52d9\u7684\u9032\u5165\u9ede"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u56e0\u70baPod\u6703\u88abcluster\u5728\u4e0d\u540c\u60c5\u6cc1\u4e0b\u8abf\u5ea6\u79fb\u52d5\uff0c\u4f7f\u7528Service\u6307\u5411Pod\uff0c\u80fd\u5920\u5728Pod\u88ab\u8abf\u5ea6\u6642\u7dad\u6301\u76f8\u540c\u7684\u5b58\u53d6\u6307\u5b9a"),(0,a.kt)("li",{parentName:"ul"},"By Selector"),(0,a.kt)("li",{parentName:"ul"},"\u5c0f\u5fc3\u592a\u5bec\u9b06\u7684selector\uff0c\u6703\u8b93Service\u5c07\u6d41\u91cf\u5c0e\u5411\u932f\u8aa4\u7684\u76ee\u6a19"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Ingress: \u5c07Pod, HTTP/WS\u7684entrypoint"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u4e00\u822c\u4f86\u8aaaby Service Name")))),(0,a.kt)("h2",{id:"configmap--secret"},"Configmap / Secret"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Secret, Configmap\u53ea\u80fd\u5728\u540c\u4e00\u500bNS")),(0,a.kt)("h2",{id:"serviceaccount"},"ServiceAccount"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"AKS/GKE \u7d66\u4e88pod permission\u7684\u4e3b\u8981\u4f9d\u64da")),(0,a.kt)("h1",{id:"kubectl-config--context"},"Kubectl Config & Context"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"kubectl\u5176\u5be6\u90fd\u662f\u5728\u8ddfK8S Cluster Master Node\u7684API\u6e9d\u901a",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u6240\u4ee5\u6709\u8a2d\u5b9a\uff0c\u6709auth token\u4e4b\u985e\u7684\u8cc7\u8a0a"))),(0,a.kt)("li",{parentName:"ul"},"kubectl\u5728\u672c\u5730\u57f7\u884c\u6642\uff0c\u76f8\u95dc\u7684\u8a2d\u5b9a\u4ee5\u53cacredentials",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"~/.kube")))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kubectl config set-context --current --namespace some-ns\n")),(0,a.kt)("h2",{id:"helm-chart"},"Helm Chart"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://helm.sh/docs/helm/helm_create/"},"https://helm.sh/docs/helm/helm_create/")),(0,a.kt)("p",null,"\u65b0\u5efa\u4e00\u500bHelm Chart"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"helm create\n")),(0,a.kt)("p",null,"\u4e3b\u8981\u7684\u5e7e\u500b\u6a94\u6848"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Chart.yaml"),(0,a.kt)("li",{parentName:"ul"},"values.yaml"),(0,a.kt)("li",{parentName:"ul"},"./templates")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'helm upgrade application-name ./charts  --install --create-namespace --atomic --debug --timeout 360s \\\n  --namespace ${{ env.namespace }} \\\n  --values "${HELM_VALUE_FILE}" \\\n  --set "Var1=123"\n  --set "Var2=456"\n')),(0,a.kt)("h2",{id:"tools"},"Tools"),(0,a.kt)("p",null,"AWS CLI\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/venth/aws-adfs"},"https://github.com/venth/aws-adfs"),"\nbrew install awscli"),(0,a.kt)("p",null,"AWS ADFS\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/venth/aws-adfs"},"https://github.com/venth/aws-adfs")),(0,a.kt)("p",null,"Helm\nbrew install helm"),(0,a.kt)("p",null,"Kubectl\nbrew install kubernetes-cli"),(0,a.kt)("p",null,"K9S/Lens\n",(0,a.kt)("a",{parentName:"p",href:"https://k8slens.dev/"},"https://k8slens.dev/"),"\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/derailed/k9s"},"https://github.com/derailed/k9s")))}m.isMDXComponent=!0}}]);